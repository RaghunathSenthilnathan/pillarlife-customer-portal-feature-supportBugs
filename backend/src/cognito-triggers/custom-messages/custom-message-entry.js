"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.main = void 0;
const custom_message_1 = __importDefault(require("./custom-message"));
if (!process.env.FRONTEND_BASE_URL) {
    throw new Error('Environment variable FRONTEND_BASE_URL is required.');
}
function main(event, _context, callback) {
    const { triggerSource, request: { codeParameter, userAttributes, usernameParameter }, } = event;
    const customMessage = new custom_message_1.default({
        userAttributes,
        codeParameter,
        usernameParameter,
    });
    if (triggerSource === 'CustomMessage_SignUp' &&
        userAttributes['cognito:user_status'] === 'UNCONFIRMED') {
        event.response = customMessage.sendCodePostSignUp();
    }
    else if (triggerSource === 'CustomMessage_ForgotPassword') {
        event.response = customMessage.sendCodeForgotPassword();
    }
    else if (triggerSource === 'CustomMessage_UpdateUserAttribute') {
        event.response = customMessage.sendCodeVerifyNewEmail();
    }
    else if (triggerSource === 'CustomMessage_AdminCreateUser') {
        event.response = customMessage.sendTemporaryPassword();
    }
    else if (triggerSource === 'CustomMessage_ResendCode') {
        event.response = customMessage.resendConfirmationCode();
    }
    callback(null, event);
}
exports.main = main;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VzdG9tLW1lc3NhZ2UtZW50cnkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjdXN0b20tbWVzc2FnZS1lbnRyeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQSxzRUFBNkM7QUFFN0MsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUU7SUFDbEMsTUFBTSxJQUFJLEtBQUssQ0FBQyxxREFBcUQsQ0FBQyxDQUFDO0NBQ3hFO0FBdUJELFNBQWdCLElBQUksQ0FDbEIsS0FBWSxFQUNaLFFBQWlCLEVBQ2pCLFFBQWtCO0lBRWxCLE1BQU0sRUFDSixhQUFhLEVBQ2IsT0FBTyxFQUFFLEVBQUMsYUFBYSxFQUFFLGNBQWMsRUFBRSxpQkFBaUIsRUFBQyxHQUM1RCxHQUFHLEtBQUssQ0FBQztJQUVWLE1BQU0sYUFBYSxHQUFHLElBQUksd0JBQWEsQ0FBQztRQUN0QyxjQUFjO1FBQ2QsYUFBYTtRQUNiLGlCQUFpQjtLQUNsQixDQUFDLENBQUM7SUFHSCxJQUNFLGFBQWEsS0FBSyxzQkFBc0I7UUFDeEMsY0FBYyxDQUFDLHFCQUFxQixDQUFDLEtBQUssYUFBYSxFQUN2RDtRQUNBLEtBQUssQ0FBQyxRQUFRLEdBQUcsYUFBYSxDQUFDLGtCQUFrQixFQUFFLENBQUM7S0FDckQ7U0FBTSxJQUFJLGFBQWEsS0FBSyw4QkFBOEIsRUFBRTtRQUMzRCxLQUFLLENBQUMsUUFBUSxHQUFHLGFBQWEsQ0FBQyxzQkFBc0IsRUFBRSxDQUFDO0tBQ3pEO1NBQU0sSUFBSSxhQUFhLEtBQUssbUNBQW1DLEVBQUU7UUFDaEUsS0FBSyxDQUFDLFFBQVEsR0FBRyxhQUFhLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztLQUN6RDtTQUFNLElBQUksYUFBYSxLQUFLLCtCQUErQixFQUFFO1FBQzVELEtBQUssQ0FBQyxRQUFRLEdBQUcsYUFBYSxDQUFDLHFCQUFxQixFQUFFLENBQUM7S0FDeEQ7U0FBTSxJQUFJLGFBQWEsS0FBSywwQkFBMEIsRUFBRTtRQUN2RCxLQUFLLENBQUMsUUFBUSxHQUFHLGFBQWEsQ0FBQyxzQkFBc0IsRUFBRSxDQUFDO0tBQ3pEO0lBR0QsUUFBUSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztBQUN4QixDQUFDO0FBbENELG9CQWtDQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q2FsbGJhY2ssIENvbnRleHR9IGZyb20gJ2F3cy1sYW1iZGEnO1xuaW1wb3J0IEN1c3RvbU1lc3NhZ2UgZnJvbSAnLi9jdXN0b20tbWVzc2FnZSc7XG5cbmlmICghcHJvY2Vzcy5lbnYuRlJPTlRFTkRfQkFTRV9VUkwpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdFbnZpcm9ubWVudCB2YXJpYWJsZSBGUk9OVEVORF9CQVNFX1VSTCBpcyByZXF1aXJlZC4nKTtcbn1cblxudHlwZSBFdmVudCA9IHtcbiAgdHJpZ2dlclNvdXJjZTogc3RyaW5nO1xuICByZXF1ZXN0OiB7XG4gICAgY29kZVBhcmFtZXRlcjogc3RyaW5nO1xuICAgIHVzZXJBdHRyaWJ1dGVzOiB7XG4gICAgICAnY29nbml0bzp1c2VyX3N0YXR1cyc6IHN0cmluZztcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgICAgIGdpdmVuX25hbWU/OiBzdHJpbmc7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gICAgICBmYW1pbHlfbmFtZT86IHN0cmluZztcbiAgICAgIGVtYWlsOiBzdHJpbmc7XG4gICAgICAvLyAnY29nbml0bzpyZWZlcnJhbF9jb2RlJz86IHN0cmluZztcbiAgICB9O1xuICAgIHVzZXJuYW1lUGFyYW1ldGVyOiBzdHJpbmc7XG4gIH07XG4gIHJlc3BvbnNlOiB7XG4gICAgZW1haWxTdWJqZWN0OiBzdHJpbmc7XG4gICAgZW1haWxNZXNzYWdlOiBzdHJpbmc7XG4gIH07XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gbWFpbihcbiAgZXZlbnQ6IEV2ZW50LFxuICBfY29udGV4dDogQ29udGV4dCxcbiAgY2FsbGJhY2s6IENhbGxiYWNrLFxuKTogdm9pZCB7XG4gIGNvbnN0IHtcbiAgICB0cmlnZ2VyU291cmNlLFxuICAgIHJlcXVlc3Q6IHtjb2RlUGFyYW1ldGVyLCB1c2VyQXR0cmlidXRlcywgdXNlcm5hbWVQYXJhbWV0ZXJ9LFxuICB9ID0gZXZlbnQ7XG5cbiAgY29uc3QgY3VzdG9tTWVzc2FnZSA9IG5ldyBDdXN0b21NZXNzYWdlKHtcbiAgICB1c2VyQXR0cmlidXRlcyxcbiAgICBjb2RlUGFyYW1ldGVyLFxuICAgIHVzZXJuYW1lUGFyYW1ldGVyLFxuICB9KTtcblxuICAvKiBlc2xpbnQtZGlzYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqL1xuICBpZiAoXG4gICAgdHJpZ2dlclNvdXJjZSA9PT0gJ0N1c3RvbU1lc3NhZ2VfU2lnblVwJyAmJlxuICAgIHVzZXJBdHRyaWJ1dGVzWydjb2duaXRvOnVzZXJfc3RhdHVzJ10gPT09ICdVTkNPTkZJUk1FRCdcbiAgKSB7XG4gICAgZXZlbnQucmVzcG9uc2UgPSBjdXN0b21NZXNzYWdlLnNlbmRDb2RlUG9zdFNpZ25VcCgpO1xuICB9IGVsc2UgaWYgKHRyaWdnZXJTb3VyY2UgPT09ICdDdXN0b21NZXNzYWdlX0ZvcmdvdFBhc3N3b3JkJykge1xuICAgIGV2ZW50LnJlc3BvbnNlID0gY3VzdG9tTWVzc2FnZS5zZW5kQ29kZUZvcmdvdFBhc3N3b3JkKCk7XG4gIH0gZWxzZSBpZiAodHJpZ2dlclNvdXJjZSA9PT0gJ0N1c3RvbU1lc3NhZ2VfVXBkYXRlVXNlckF0dHJpYnV0ZScpIHtcbiAgICBldmVudC5yZXNwb25zZSA9IGN1c3RvbU1lc3NhZ2Uuc2VuZENvZGVWZXJpZnlOZXdFbWFpbCgpO1xuICB9IGVsc2UgaWYgKHRyaWdnZXJTb3VyY2UgPT09ICdDdXN0b21NZXNzYWdlX0FkbWluQ3JlYXRlVXNlcicpIHtcbiAgICBldmVudC5yZXNwb25zZSA9IGN1c3RvbU1lc3NhZ2Uuc2VuZFRlbXBvcmFyeVBhc3N3b3JkKCk7XG4gIH0gZWxzZSBpZiAodHJpZ2dlclNvdXJjZSA9PT0gJ0N1c3RvbU1lc3NhZ2VfUmVzZW5kQ29kZScpIHtcbiAgICBldmVudC5yZXNwb25zZSA9IGN1c3RvbU1lc3NhZ2UucmVzZW5kQ29uZmlybWF0aW9uQ29kZSgpO1xuICB9XG5cbiAgLy8gUmV0dXJuIHRvIEFtYXpvbiBDb2duaXRvXG4gIGNhbGxiYWNrKG51bGwsIGV2ZW50KTtcbn1cbiJdfQ==